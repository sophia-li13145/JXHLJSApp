<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:controls="clr-namespace:IndustrialControlMAUI.Controls"
             x:Class="IndustrialControlMAUI.Pages.LoginPage"
             BackgroundColor="White"
             Shell.NavBarIsVisible="False"
             Padding="0">

    <Grid RowDefinitions="Auto,*,Auto">
        <!-- 顶部背景（图片2） -->
        <Grid Grid.Row="0">
            <!-- 请将图片2保存为 Resources/Images/factory_bg.png（Build Action: MauiImage） -->
            <Image Source="factory_bg.png"
                   Aspect="AspectFill"
                   HeightRequest="{OnIdiom Phone=250, Tablet=260, Desktop=220}" />
            <!-- 半透明遮罩，让标题更清晰 -->
            <BoxView BackgroundColor="#80000000" />
        </Grid>

        <!-- 中部表单 -->
        <ScrollView Grid.Row="1" Padding="20,10">
            <VerticalStackLayout Spacing="16" VerticalOptions="CenterAndExpand">

                <!-- 用户名 -->
                <Frame HasShadow="False" CornerRadius="12"
                       BackgroundColor="#F6F7F9" BorderColor="#E6E7EB" Padding="12">
                    <Grid ColumnDefinitions="Auto,*" ColumnSpacing="10">
                        <!-- 可用你自己的图标：user_icon.png -->
                        <Image Source="user_icon.png" WidthRequest="20" HeightRequest="20" VerticalOptions="Center"/>
                        <Entry x:Name="UserNameEntry"
                               Grid.Column="1"
                               Placeholder="用户名"
                               Text="{Binding UserName}"
                               ReturnType="Next"/>
                    </Grid>
                </Frame>

                <!-- 密码 + 显示/隐藏 -->
                <Frame HasShadow="False" CornerRadius="12"
                       BackgroundColor="#F6F7F9" BorderColor="#E6E7EB" Padding="12">
                    <Grid ColumnDefinitions="Auto,*" ColumnSpacing="10">
                        <Image Source="lock_icon.png" WidthRequest="20" HeightRequest="20" VerticalOptions="Center"/>
                        <controls:PasswordEntryView Grid.Column="1"
                                                    Placeholder="密码"
                                                    Text="{Binding Password}"
                                                    ShowPassword="{Binding ShowPassword}"
                                                    TogglePasswordCommand="{Binding TogglePasswordCommand}" />
                    </Grid>
                </Frame>

                <!-- 记住密码 + 清除记录 -->
                <Grid ColumnDefinitions="Auto,*,Auto" VerticalOptions="Center" Padding="4,0">
                    <CheckBox IsChecked="{Binding RememberPassword}" VerticalOptions="Center"/>
                    <Label Grid.Column="1" Text="记住密码" VerticalOptions="Center" TextColor="#333"/>
                    <Button Grid.Column="2"
                            Text="清除记录"
                            BackgroundColor="Transparent"
                            TextColor="#4A90E2"
                            Command="{Binding ClearHistoryCommand}"/>
                </Grid>

                <!-- 登录按钮 -->
                <Grid RowDefinitions="Auto,Auto" RowSpacing="8">
                    <Button Grid.Row="0"
                            Text="登 录"
                            HeightRequest="48"
                            CornerRadius="24"
                            FontAttributes="Bold"
                            TextColor="White"
                            BackgroundColor="#4A90E2"
                            Command="{Binding LoginCommand}"
                            >
                    </Button>

                    <!-- 忙碌态 -->
                    <HorizontalStackLayout Grid.Row="1" Spacing="8" HorizontalOptions="Center">
                        <ActivityIndicator IsRunning="{Binding IsBusy}" IsVisible="{Binding IsBusy}"/>
                        <Label Text="正在登录…" IsVisible="{Binding IsBusy}" TextColor="#666" />
                    </HorizontalStackLayout>
                </Grid>
            </VerticalStackLayout>
        </ScrollView>

        <!-- 底部版权 -->
        <Label Grid.Row="2"
               Text="Copyright © 2025 BeiJingLianChuang"
               HorizontalOptions="Center"
               Margin="0,10"
               FontSize="12"
               TextColor="#888"/>
    </Grid>
</ContentPage>
